(function(a){a.fn.quicksand=function(v,n,s){function t(e){var c=[],f=a(e).get(0).nodeName.toLowerCase();if(a(e).attr("id"))f+="#"+a(e).attr("id");c.push(f);a(e).parentsUntil("html").each(function(){f=a(this).get(0).nodeName.toLowerCase();if(a(this).attr("id"))f+="#"+a(this).attr("id");c.push(f)});return c.reverse().join(" > ")}var b={duration:750,easing:"swing",attribute:"data-id",adjustHeight:true};a.extend(b,n);b.selector=null;a.extend(b,{selector:"> *"});var m;if(typeof n=="function")m=n;else if(typeof(s==
"function"))m=s;return this.each(function(){var e=a(v).clone(),c=a(this);a(this).css("height");var f=a(c).offset(),p=[],i=parseFloat(a("body").css("border-left-width")),j=parseFloat(a("body").css("border-top-width")),k=a(this).find(b.selector),g=0,h=0,u=0,l=function(){if(!u){c.html(q.html());a("[data-quicksand-owner="+t(c)+"]").remove();typeof m=="function"&&m.call(this);u=1}};c.css("height",a(this).height());a(k.parentsUntil("html").toArray().reverse()).each(function(){if(a(this).css("position")==
"relative"){o=a(this).offset();g=o.top;h=o.left}});k.each(function(d){p[d]=a(this).offset()});a(this).stop();k.each(function(d){a(this).stop();a(this).css("position","absolute").css("margin",0).css("top",p[d].top-parseFloat(a(this).css("margin-top"))+j-g).css("left",p[d].left-parseFloat(a(this).css("margin-left"))+i-h)});var q=a(c).clone().html("").attr("id","").attr("data-quicksand-owner",c.selector).css("height","auto").css("width",c.width()+"px").append(e);q.insertBefore(c).css("z-index",-1).css("opacity",
0).css("margin",0).css("position","absolute").css("top",f.top+j-g).css("left",f.left+i-h).attr("data-quicksand-owner",t(c));b.adjustHeight&&c.animate({height:q.height()},b.duration,b.easing,function(){c.css("height","auto")});k.each(function(){var d=e.filter("["+b.attribute+"="+a(this).attr(b.attribute)+"]");if(d.length)a.browser.msie?a(this).animate({top:d.offset().top+j-g,left:d.offset().left+i-h,opacity:1},b.duration,b.easing,l):a(this).animate({top:d.offset().top+j-g,left:d.offset().left+i-h,
opacity:1,scale:"1.0"},b.duration,b.easing,l);else a.browser.msie?a(this).animate({opacity:"0.0"},b.duration,b.easing,l):a(this).animate({opacity:"0.0",scale:"0.0"},b.duration,b.easing,l)});e.each(function(){var d=k.filter("["+b.attribute+"="+a(this).attr(b.attribute)+"]"),r=e.filter("["+b.attribute+"="+a(this).attr(b.attribute)+"]");if(d.length===0){d=a.browser.msie?{opacity:"1.0"}:{opacity:"1.0",scale:"1.0"};r.clone().css("position","absolute").css("margin",0).css("top",r.offset().top+j-g).css("left",
r.offset().left+i-h).css("opacity",0).css("transform","scale(0.0)").appendTo(c).animate(d,b.duration,b.easing,l)}})})}})(jQuery);
